{"componentChunkName":"component---src-templates-blog-post-js","path":"/2021-07-25-create-blog-by-gatsby/","result":{"data":{"site":{"siteMetadata":{"title":"Hashimoto's Blog"}},"markdownRemark":{"id":"8cc242e3-77b8-5d4f-be00-93c1bb0efd41","excerpt":"なぜ Gatsby でブログを作ろうと思ったか アウトプット三日坊主を克服したいと思い立ち、ブログを作りました。 技術でも日常のことでも自由に書ける空間がとりあえず欲しかったので、個人ブログを立ち上げてみることにしました。 Gatsby は React ベースの SSG…","html":"<h2>なぜ Gatsby でブログを作ろうと思ったか</h2>\n<p>アウトプット三日坊主を克服したいと思い立ち、ブログを作りました。</p>\n<p>技術でも日常のことでも自由に書ける空間がとりあえず欲しかったので、個人ブログを立ち上げてみることにしました。</p>\n<p>Gatsby は React ベースの SSG(静的サイトジェネレータ)フレームワークだそう。<br>\nデータ取得まわりは GrahphQL を採用しているようです。</p>\n<p><a href=\"https://www.gatsbyjs.com/\">Gatsby 公式サイト</a></p>\n<p>最近業務で React Native + GraphQL でアプリ開発をしているので、勉強しつつ色々カスタマイズできたらいいなと思い Gatsby を選択しました。</p>\n<p>トータル 2 時間ぐらいで手軽に作成して公開できたので、メモ書き程度に手順を残しておきます。</p>\n<h2>作成手順</h2>\n<h3>ローカルにプロジェクトを作成</h3>\n<ul>\n<li>ブログ用のスターター(テンプレート)を使って、ローカルにプロジェクトを作成します。</li>\n</ul>\n<p>スターターは一番シンプル&#x26;スターが多かった gatsby-starter-blog をチョイスしました。<br>\n<a href=\"https://github.com/gatsbyjs/gatsby-starter-blog\">gatsbyjs/gatsby-starter-blog</a></p>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\">// gatsby-cliのインストール\n$ <span class=\"token function\">npm</span> i -g gatsby\n\n// プロジェクトの作成\n$ gatsby new my-blog-starter https://github.com/gatsbyjs/gatsby-starter-blog\n\n$ <span class=\"token builtin class-name\">cd</span> my-blog-starter</code></pre></div>\n<h3>内容の編集</h3>\n<ul>\n<li>ブログのタイトルや author, twitter アカウントあたりを編集。初期値は以下のようになっています。</li>\n</ul>\n<div class=\"gatsby-highlight\" data-language=\"js\"><pre class=\"language-js\"><code class=\"language-js\"><span class=\"token comment\">// gatsby-config.js</span>\nmodule<span class=\"token punctuation\">.</span>exports <span class=\"token operator\">=</span> <span class=\"token punctuation\">{</span>\n  siteMetadata<span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span>\n    title<span class=\"token operator\">:</span> <span class=\"token template-string\"><span class=\"token template-punctuation string\">`</span><span class=\"token string\">Gatsby Starter Blog</span><span class=\"token template-punctuation string\">`</span></span><span class=\"token punctuation\">,</span>\n    author<span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span>\n      name<span class=\"token operator\">:</span> <span class=\"token template-string\"><span class=\"token template-punctuation string\">`</span><span class=\"token string\">Kyle Mathews</span><span class=\"token template-punctuation string\">`</span></span><span class=\"token punctuation\">,</span>\n      summary<span class=\"token operator\">:</span> <span class=\"token template-string\"><span class=\"token template-punctuation string\">`</span><span class=\"token string\">who lives and works in San Francisco building useful things.</span><span class=\"token template-punctuation string\">`</span></span><span class=\"token punctuation\">,</span>\n    <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n    description<span class=\"token operator\">:</span> <span class=\"token template-string\"><span class=\"token template-punctuation string\">`</span><span class=\"token string\">A starter blog demonstrating what Gatsby can do.</span><span class=\"token template-punctuation string\">`</span></span><span class=\"token punctuation\">,</span>\n    siteUrl<span class=\"token operator\">:</span> <span class=\"token template-string\"><span class=\"token template-punctuation string\">`</span><span class=\"token string\">https://gatsby-starter-blog-demo.netlify.app/</span><span class=\"token template-punctuation string\">`</span></span><span class=\"token punctuation\">,</span>\n    social<span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span>\n      twitter<span class=\"token operator\">:</span> <span class=\"token template-string\"><span class=\"token template-punctuation string\">`</span><span class=\"token string\">kylemathews</span><span class=\"token template-punctuation string\">`</span></span><span class=\"token punctuation\">,</span>\n    <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span></code></pre></div>\n<ul>\n<li>\n<p>記事データは<code class=\"language-text\">/content/</code> ディレクトリ内にあります。新しく記事を書くときには、このディレクトリにファイルを追加していきます。<br>\nデモ用の記事が入っているので、編集もしくは削除しておくのも忘れないこと。</p>\n</li>\n<li>\n<p>プロフィール画像は <code class=\"language-text\">./src/images/profile-pic.png</code>を差し替えます。もしくは <code class=\"language-text\">./src/components/bio.js</code>で画像パスを書き換えます。</p>\n</li>\n<li>\n<p>ファビコン画像は <code class=\"language-text\">./src/images/gatsby-icon.png</code>を差し替えます。もしくは <code class=\"language-text\">./gatsby-config.js</code> で画像を指定しているパスを書き換えます。</p>\n</li>\n</ul>\n<div class=\"gatsby-highlight\" data-language=\"js\"><pre class=\"language-js\"><code class=\"language-js\"><span class=\"token comment\">// gatsby-config.js</span>\n\nplugins<span class=\"token operator\">:</span> <span class=\"token punctuation\">[</span>\n  <span class=\"token punctuation\">{</span>\n    resolve<span class=\"token operator\">:</span> <span class=\"token template-string\"><span class=\"token template-punctuation string\">`</span><span class=\"token string\">gatsby-plugin-manifest</span><span class=\"token template-punctuation string\">`</span></span><span class=\"token punctuation\">,</span>\n    options<span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span>\n      name<span class=\"token operator\">:</span> <span class=\"token template-string\"><span class=\"token template-punctuation string\">`</span><span class=\"token string\">Gatsby Starter Blog</span><span class=\"token template-punctuation string\">`</span></span><span class=\"token punctuation\">,</span>\n      short_name<span class=\"token operator\">:</span> <span class=\"token template-string\"><span class=\"token template-punctuation string\">`</span><span class=\"token string\">GatsbyJS</span><span class=\"token template-punctuation string\">`</span></span><span class=\"token punctuation\">,</span>\n      start_url<span class=\"token operator\">:</span> <span class=\"token template-string\"><span class=\"token template-punctuation string\">`</span><span class=\"token string\">/</span><span class=\"token template-punctuation string\">`</span></span><span class=\"token punctuation\">,</span>\n      background_color<span class=\"token operator\">:</span> <span class=\"token template-string\"><span class=\"token template-punctuation string\">`</span><span class=\"token string\">#ffffff</span><span class=\"token template-punctuation string\">`</span></span><span class=\"token punctuation\">,</span>\n      theme_color<span class=\"token operator\">:</span> <span class=\"token template-string\"><span class=\"token template-punctuation string\">`</span><span class=\"token string\">#663399</span><span class=\"token template-punctuation string\">`</span></span><span class=\"token punctuation\">,</span>\n      display<span class=\"token operator\">:</span> <span class=\"token template-string\"><span class=\"token template-punctuation string\">`</span><span class=\"token string\">minimal-ui</span><span class=\"token template-punctuation string\">`</span></span><span class=\"token punctuation\">,</span>\n      icon<span class=\"token operator\">:</span> <span class=\"token template-string\"><span class=\"token template-punctuation string\">`</span><span class=\"token string\">src/images/gatsby-icon.png</span><span class=\"token template-punctuation string\">`</span></span><span class=\"token punctuation\">,</span> <span class=\"token comment\">// これ</span>\n    <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n<span class=\"token punctuation\">]</span></code></pre></div>\n<ul>\n<li>ローカルでビルドして確認。</li>\n</ul>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\">$ gatsby develop</code></pre></div>\n<p>上手くいっていれば <code class=\"language-text\">http://localhost:8000</code> で確認できます。</p>\n<h2>GitHub Pages にデプロイする</h2>\n<ul>\n<li>\n<p>リポジトリを作成します。<br>\n今回は<code class=\"language-text\">github.io</code>のサブドメインを使いたかったので、<code class=\"language-text\">{gituhubユーザー名}/github.io</code>の名前でリポジトリを作成しました。</p>\n<p><a href=\"https://github.com/marinahashimoto/marinahashimoto.github.io\">marinahashimoto/marinahashimoto.github.io</a></p>\n</li>\n<li>\n<p>main ブランチはビルド時に public フォルダ内の公開ファイルが Push されるので、Gatsby 本体のソースは別ブランチ(今回は source)に Push します。<br>\nもし間違えて Gatsby 本体を main に Push してしまっても、ビルド時に自動的に main から不要なファイルは削除されるので、落ち着いて別ブランチを切れば問題ないです。</p>\n</li>\n</ul>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\">$ <span class=\"token function\">git</span> init\n$ <span class=\"token function\">git</span> checkout -b <span class=\"token builtin class-name\">source</span>\n$ <span class=\"token function\">git</span> <span class=\"token function\">add</span> <span class=\"token builtin class-name\">.</span>\n$ <span class=\"token function\">git</span> commit -m <span class=\"token string\">\"gatsby first setting\"</span>\n$ <span class=\"token function\">git</span> push origin <span class=\"token builtin class-name\">source</span></code></pre></div>\n<ul>\n<li>ローカルでコマンドを叩いてビルド&#x26;公開します。</li>\n</ul>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\">gatsby build <span class=\"token operator\">&amp;&amp;</span> gh-pages -d public -b main</code></pre></div>\n<h2>GitHub Actions で Push 時に自動デプロイする</h2>\n<ul>\n<li>アクションを定義する yaml ファイル<code class=\"language-text\">./.github/workflows/gh-pages.yml</code> を作成します。</li>\n</ul>\n<div class=\"gatsby-highlight\" data-language=\"yml\"><pre class=\"language-yml\"><code class=\"language-yml\"><span class=\"token key atrule\">name</span><span class=\"token punctuation\">:</span> GitHub Pages\n\n<span class=\"token key atrule\">on</span><span class=\"token punctuation\">:</span>\n  <span class=\"token key atrule\">push</span><span class=\"token punctuation\">:</span>\n    <span class=\"token key atrule\">branches</span><span class=\"token punctuation\">:</span>\n      <span class=\"token punctuation\">-</span> source\n  <span class=\"token key atrule\">pull_request</span><span class=\"token punctuation\">:</span>\n\n<span class=\"token key atrule\">jobs</span><span class=\"token punctuation\">:</span>\n  <span class=\"token key atrule\">deploy</span><span class=\"token punctuation\">:</span>\n    <span class=\"token key atrule\">runs-on</span><span class=\"token punctuation\">:</span> ubuntu<span class=\"token punctuation\">-</span><span class=\"token number\">20.04</span>\n    <span class=\"token key atrule\">concurrency</span><span class=\"token punctuation\">:</span>\n      <span class=\"token key atrule\">group</span><span class=\"token punctuation\">:</span> $<span class=\"token punctuation\">{</span><span class=\"token punctuation\">{</span> github.workflow <span class=\"token punctuation\">}</span><span class=\"token punctuation\">}</span><span class=\"token punctuation\">-</span>$<span class=\"token punctuation\">{</span><span class=\"token punctuation\">{</span> github.ref <span class=\"token punctuation\">}</span><span class=\"token punctuation\">}</span>\n    <span class=\"token key atrule\">steps</span><span class=\"token punctuation\">:</span>\n      <span class=\"token punctuation\">-</span> <span class=\"token key atrule\">uses</span><span class=\"token punctuation\">:</span> actions/checkout@v2\n\n      <span class=\"token punctuation\">-</span> <span class=\"token key atrule\">name</span><span class=\"token punctuation\">:</span> Setup Node\n        <span class=\"token key atrule\">uses</span><span class=\"token punctuation\">:</span> actions/setup<span class=\"token punctuation\">-</span>node@v2\n        <span class=\"token key atrule\">with</span><span class=\"token punctuation\">:</span>\n          <span class=\"token key atrule\">node-version</span><span class=\"token punctuation\">:</span> <span class=\"token string\">\"12\"</span>\n\n      <span class=\"token punctuation\">-</span> <span class=\"token key atrule\">name</span><span class=\"token punctuation\">:</span> Cache dependencies\n        <span class=\"token key atrule\">uses</span><span class=\"token punctuation\">:</span> actions/cache@v2\n        <span class=\"token key atrule\">with</span><span class=\"token punctuation\">:</span>\n          <span class=\"token key atrule\">path</span><span class=\"token punctuation\">:</span> ~/.npm\n          <span class=\"token key atrule\">key</span><span class=\"token punctuation\">:</span> $<span class=\"token punctuation\">{</span><span class=\"token punctuation\">{</span> runner.os <span class=\"token punctuation\">}</span><span class=\"token punctuation\">}</span><span class=\"token punctuation\">-</span>node<span class=\"token punctuation\">-</span>$<span class=\"token punctuation\">{</span><span class=\"token punctuation\">{</span> hashFiles('<span class=\"token important\">**/package-lock.json')</span> <span class=\"token punctuation\">}</span><span class=\"token punctuation\">}</span>\n          <span class=\"token key atrule\">restore-keys</span><span class=\"token punctuation\">:</span> <span class=\"token punctuation\">|</span><span class=\"token scalar string\">\n            ${{ runner.os }}-node-</span>\n\n      <span class=\"token punctuation\">-</span> <span class=\"token key atrule\">name</span><span class=\"token punctuation\">:</span> Install dependencies\n        <span class=\"token key atrule\">run</span><span class=\"token punctuation\">:</span> yarn install <span class=\"token punctuation\">-</span><span class=\"token punctuation\">-</span>frozen<span class=\"token punctuation\">-</span>lockfile\n\n      <span class=\"token punctuation\">-</span> <span class=\"token key atrule\">name</span><span class=\"token punctuation\">:</span> Run build for GitHub Pages\n        <span class=\"token key atrule\">run</span><span class=\"token punctuation\">:</span> npm run build\n\n      <span class=\"token punctuation\">-</span> <span class=\"token key atrule\">name</span><span class=\"token punctuation\">:</span> Deploy\n        <span class=\"token key atrule\">uses</span><span class=\"token punctuation\">:</span> peaceiris/actions<span class=\"token punctuation\">-</span>gh<span class=\"token punctuation\">-</span>pages@v3\n        <span class=\"token key atrule\">with</span><span class=\"token punctuation\">:</span>\n          <span class=\"token key atrule\">github_token</span><span class=\"token punctuation\">:</span> $<span class=\"token punctuation\">{</span><span class=\"token punctuation\">{</span> secrets.GITHUB_TOKEN <span class=\"token punctuation\">}</span><span class=\"token punctuation\">}</span>\n          <span class=\"token key atrule\">publish_dir</span><span class=\"token punctuation\">:</span> ./public\n          <span class=\"token key atrule\">publish_branch</span><span class=\"token punctuation\">:</span> main</code></pre></div>\n<ul>\n<li>これでローカルでコマンドを叩かなくても source ブランチに Push するたびに、自動デプロイが走ります。</li>\n</ul>\n<h2>少しカスタマイズする</h2>\n<h3>日本語フォントに Google Font を適用する</h3>\n<p>スターターのままだと日本語フォントがいまいちなので、Google Font をプラグインで入れました。<br>\n<a href=\"https://www.gatsbyjs.com/docs/recipes/styling-css/#using-google-fonts\">Gatsby 公式 Google フォントの導入方法</a></p>\n<h3>Google Analytics を導入</h3>\n<p>gatsby-starter-blog で作成していれば既にプラグインがインストールされているので、トラッキング ID だけ入れれば OK。</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">    {\n      resolve: `gatsby-plugin-google-analytics`,\n      options: {\n        trackingId: `ADD YOUR TRACKING ID HERE`,\n      },\n    },</code></pre></div>\n<h2>感想</h2>\n<p>Gatsby でのブログ作成、さくっと作れたのが良かったです。<br>\nプラグインも豊富そうなので、自分好みのブログにしようとすると、どんどん時間が溶けていきそう…<br>\nいま実務だとあまり Web フロントの開発をすることが無いので、ぼちぼち勉強も兼ねてカスタマイズしていきたいです。</p>\n<h2>Reference list</h2>\n<ul>\n<li><a href=\"https://zenn.dev/tossy_yukky/articles/3681a314b3f6ef86a4cf\">Gatsby と Netlify（と AWS Route53）を使って 30 分でブログを作る</a></li>\n<li><a href=\"https://suzukalight.com/blog/posts/2019-06-29-hello-world\">Gatsby + GitHub Pages でブログを構築</a></li>\n<li><a href=\"https://qiita.com/peaceiris/items/2f6d83802f2aefa66f9d\">Gatsby のサイトを GitHub Actions で GitHub Pages にデプロイ</a></li>\n</ul>","frontmatter":{"title":"Gatsby + GitHub Pages + GitHub Actions で個人ブログを作った","date":"July 25, 2021","description":null}},"previous":{"fields":{"slug":"/about-me/"},"frontmatter":{"title":"About me"}},"next":{"fields":{"slug":"/2021-08-07/"},"frontmatter":{"title":"帝京大学理工学部情報科学科(通信教育課程)へ2年次編入しました"}}},"pageContext":{"id":"8cc242e3-77b8-5d4f-be00-93c1bb0efd41","previousPostId":"a4d75c15-3581-5ccc-84c9-e4ca5ce1552c","nextPostId":"413bfe08-78ba-54e2-975c-cb6ac62ae580"}},"staticQueryHashes":["2228499549","2355076697"]}